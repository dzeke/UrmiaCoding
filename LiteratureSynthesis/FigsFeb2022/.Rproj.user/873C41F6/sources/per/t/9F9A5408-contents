---
title: "Farm Size Distributions in Iran, Urmia Basin, and Utah, USA"
author: "David E. Rosenberg"
date: "May 5, 2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Introduction

This is an R Markdown document. This script reads farm size distributions digitized from Utah (2002) and Lake Urmia (2021). The script then plots distributions for Iran and Urmia Basin (Figure 1), Utah (Figure 2), and Iran, Urmia Basin, and Iran (Figure 3).

## Input files:
 
 1. **FarmSizeDistributions.xlsx** - Excel file with farm size distributions digitized from figures. Utah data are from Utah State University Extension - Farm and Ranch Irrigation Survey (2013) and Census of Agriculture (Nov 2014). Iran data are from Hajmoradi, A. (2021), Director of ULRP management divisionRep., Urmia Lake Restoration Program. https://drive.google.com/file/d/1xz1_IXv_ou9D1vMIpCWr-_eFjp_5FXNR/view?usp=drive_web.
 
## Ouput files:

 1. **FarmSizeDistribution.pdf** - pdf file with all the figures

## Main Findings

 1. Urmia basin farms are smaller than farms throughout Iran.
 2. Urmia and Iran farms are smaller than Utah farms.
 
## Recommended Citation
David E. Rosenberg (2021). "Farm Size Distributions in Iran, Urmia Basin, and Utah, USA", Utah State University, Logan, Utah. https://github.com/dzeke/UrmiaCoding/tree/main/LiteratureSynthesis/FigsApril2021

```{r Includes, echo=FALSE, results=FALSE, fig.width=13, fig.height=8, include=FALSE}



library(bibliometrix)   ### load bibliometrix package
library(ggplot2)
library(dplyr)
library(lubridate)
library(plyr)
library(data.table)
library(stringr)
library(reshape)  #melt

if (!require(readxl)) { 
  install.packages("readxl", repos="http://cran.r-project.org") 
  library(readxl) 
}

if (!require(RColorBrewer)) { 
  install.packages("RColorBrewer",repos="http://cran.r-project.org") 
  library(RColorBrewer) # 
}


if (!require(pracma)) {  #interp1 and interpNA
  install.packages("pracma", repos="http://cran.r-project.org") 
  library(pracma) 
}


# Read in the excel data

sExcelFile <- 'FarmSizeDistributions.xlsx'
dfUrmiaIran <- read_excel(sExcelFile, sheet = "Iran",  range = "A3:C9")
dfUtah <- read_excel(sExcelFile, sheet = "Utah",  range = "A3:C11")

#Convert acres to hectares
nAcresToHectares = 0.405

```
\newpage

# Figure 1. Farm size distributions in Iran and Urmia

```{r Plot1, echo=FALSE,results='hide',fig.keep='all', fig.height=4.5, warning=FALSE}

#Cumulative plot of Iran data streams
ggplot() +
  geom_line(data = dfUrmiaIran, aes(x=dfUrmiaIran$Hectares, y=cumsum(dfUrmiaIran$Urmia), color="Urmia"), size=2) + 
  geom_line(data = dfUrmiaIran, aes(x=dfUrmiaIran$Hectares, y=cumsum(dfUrmiaIran$Iran), color="Iran"), size=2) + 
  
  labs(y="Cumulative Percent", x = "Area (Hectares)") +

  scale_color_manual(breaks=c("Iran","Urmia"), values=c("Red","Pink")) +
  
  theme_bw() +
  theme(text = element_text(size=20), legend.text=element_text(size=16),
        legend.title = element_blank())


```
\newpage

# Figure 2. Farm size distributions in Utah

```{r Plot2, echo=FALSE,results='hide',fig.keep='all', fig.height=4.5, warning=FALSE}


#Cumulative plot of Utah data streams
ggplot(dfUtah) +
  geom_line(aes(x=dfUtah$`Area (acres)` * nAcresToHectares, y=cumsum(dfUtah$`Percent of Total Acres`), color="Utah by Area"), size=2) + 
  geom_line(aes(x=dfUtah$`Area (acres)` * nAcresToHectares, y=cumsum(dfUtah$`Percent of total number of farms`), color="Utah by # of Farms"), size=2) + 
  
  labs(y="Cumulative Percent", x = "Area (Hectares)") +
  
  scale_color_manual(breaks=c("Utah by Area","Utah by # of Farms"), values=c("Blue","Lightblue")) +
  
  theme_bw() +
  theme(text = element_text(size=20), legend.text=element_text(size=16),
        legend.title = element_blank())


```
\newpage

# Figure 3. Farm size distributions in Iran, Urmia, and Utah

```{r Plot3, echo=FALSE,results='hide',fig.keep='all', fig.height=4.5, warning=FALSE}

#Cumulative plot of Iran and Utah data streams

ggplot() +
  geom_line(data = dfUrmiaIran, aes(x=dfUrmiaIran$Hectares, y=cumsum(dfUrmiaIran$Urmia), color="Urmia"), size=2) + 
  geom_line(data = dfUrmiaIran, aes(x=dfUrmiaIran$Hectares, y=cumsum(dfUrmiaIran$Iran), color="Iran"), size=2) + 
  geom_line(data = dfUtah, aes(x= `Area (acres)` * nAcresToHectares, y=cumsum(`Percent of Total Acres`), color="Utah"), size=2) +
  
  labs(y="Cumulative Percent", x = "Area (Hectares)") +
  
  scale_color_manual(breaks=c("Urmia","Iran","Utah"), values=c("Pink","Red","Blue")) +
  
  scale_x_continuous(limits = c(0,55)) + 
  
  theme_bw() +
  theme(text = element_text(size=20), legend.text=element_text(size=16),
        legend.title = element_blank())
